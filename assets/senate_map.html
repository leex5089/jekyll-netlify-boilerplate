<script>
  import Seo from '$lib/Seo.svelte';
</script>


<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Show and hide layers</title>
<meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
<link href="https://api.mapbox.com/mapbox-gl-js/v2.12.0/mapbox-gl.css" rel="stylesheet">
<script src="https://api.mapbox.com/mapbox-gl-js/v2.12.0/mapbox-gl.js"></script>
<style>
body { margin: 0; padding: 0; }
#map { position: absolute; top: 0; bottom: 0; width: 100%; }
</style>
</head>
<body>
<style>

  a:link {
  color: #237EDE;
  background-color: transparent;
  text-decoration: none;
}

a:visited {
  color: #237EDE;
  background-color: transparent;
  text-decoration: none;
}

a:hover {
  color: #0422FC;
  background-color: transparent;
  text-decoration: underline;
}

a:active {
  color: #237EDE;
  background-color: transparent;
  text-decoration: underline;
}
.center {
  margin-left: auto;
  margin-right: auto;
}
.styled-table { 
  overflow:scroll;
    overflow-x:hidden;
  width: 90%;
  height: 1%;  
     border-collapse: collapse;
    margin: 1% 0;
    font-size: 9px;
    font-family: sans-serif;
    box-shadow: 0 0 5% rgba(0, 0, 0, 0.15);
            text-align: center;

}
.styled-table thead tr {
    background-color: #5b87c2;
    color: #ffffff;
    text-align: left;
        height: 19px;

}
.styled-table tbody tr.active-row {
    font-weight: bold;
    color: #5b87c2;
    min-width: 2px;
    max-width: 2px;
    width:  2px;
        text-align: left;
        height: 19px;

}

 




 

.styled-table th,
.styled-table td {
      overflow: hidden; 
    text-overflow: ellipsis; 
    word-wrap: break-word;
    padding: 0.3% 0.3%;
    width:  25%; 

}
.styled-table tbody tr {
    border-bottom: 0.1% solid #dddddd;
            text-align: left;
        height: 19px;

}

.styled-table tbody tr:nth-of-type(even) {
    background-color: #d3deed;
            text-align: left;
        height: 19px;

}

.styled-table tbody tr:last-of-type {
    border-bottom:  0.1% solid #5b87c2;
            text-align: left;
        height: 19px;

}
.quakeInfo {
  overflow:scroll;
    overflow-x:hidden;
  position: relative;
  font-family: sans-serif;
  margin-top: 0.1%;
  margin-left: 0.1%;
  padding: 0.3%;
  width: 45%;
  height: 95%;
  border: 2px solid black;
  font-size: 15%;
  color: #000000;
  background-color: rgba(215, 235, 265, 0.93);
  border-radius: 2%;
}

</style>
 
<nav id="menu"></nav>
<div id="map"></div>
 
 
 <div class='quakeInfo'>
 <div><strong><font size="2">How Different Early Care and Education (ECE) Approaches Impact Families with Young Children

  <p></p>

</font></strong>  </div>
 <div><strong><font size="1.3">Instructions:  </strong>
                        
 
<ul>
  <li><strong>Rollover, click, or touch a district to view data. </strong></li>
  <li><strong>Zoom in/out or position map with cursor or finger to access a district. </strong></li> 
</ul>  
</font>  </div>



<div><strong><font size="1.3">Senate District:</strong> <span style="color:blue; font-size:150%; background-color:#dba9a9;" id='DISTRICT'></span></div>

<div><strong><font size="1.3">Number of families with children under 5:</strong> <span style="color:blue" id='n_fam_u5'></span></div>

<p></p>

 <div> <font size="1.6">Policy Approaches: 

  <p></p>

<ul>
  <li>Targeted: Fully fund subsidies targeted to low-income families.</li>
  <li>Plus Middle Income: Targeted policy plus middle-income family ECE payments capped at 7% of income.</li> 
</ul>   
 
 </div>






<table class="styled-table" style="text-align:center">
        <td colspan="4" style="text-align:center" ><strong><font size="1.3"  >More moms working and moving from part-time to full-time employment</strong> </td>


      <thead>
      <thead>
 
  <tr>
      <td></td>
    <td style="text-align:center">Current</td>
    <td style="text-align:center">Targeted</td>
    <td style="text-align:center">Plus Middle Income</td>
  </tr>
      </thead>

  <tr class="active-row">
    <td>Employed</td>

    <td style="text-align:center"><span id='emp_ba'></span></td>
    <td style="text-align:center"><span id='emp_n'></span></td>
    <td style="text-align:center"><span id='emp_br'></span></td>
  </tr>
  <tr >
    <td>Employed full time</td>

    <td style="text-align:center"><span id='ftemp_ba'></span></td>
    <td style="text-align:center"><span id='ftemp_n'></span></td>
    <td style="text-align:center"><span id='ftemp_br'></span></td>
  </tr>  

      <td colspan="4" class="cap foot">
        Percent of females age 20-64 with children under age 5
    </td>   
</table>
 

<p></p>
 
<table class="styled-table"  style="text-align:center"> 
        <td colspan="4" style="text-align:center" ><strong><font size="1.3"  >Lower ECE costs for families</strong> </td>

   
  <tr class="active-row">
      <td  ></td>
    <td  ></td> 
    <td colspan="2" style="text-align:center" bgcolor=#d3deed>Average annual savings</td>
  </tr>
      <thead>

      <thead>

  <tr>
      <td></td>
    <td style="text-align:center">Current</td>
    <td style="text-align:center">Targeted</td>
    <td style="text-align:center">Plus Middle Income</td>
  </tr>
      </thead>

  <tr class="active-row">
    <td>Paying 50 weeks of ECE annually</td>

    <td style="text-align:center"><span id='exp_ba'></span></td>
    <td style="text-align:center"><span id='exp_diff_n'></span></td>
    <td style="text-align:center"><span id='exp_diff_b'></span></td>
  </tr>
     <td colspan="4" class="cap foot">
        Average annual ECE household expenditures
    </td>
</table>



<p></p>
   
<table class="styled-table"  style="text-align:center">
        <td colspan="4" style="text-align:center" ><strong><font size="1.3"  >More opportunity for families to use licensed ECE providers</strong> </td>


      <thead>
      <thead>

  <tr class="active-row">
      <td></td>
    <td style="text-align:center">Current</td>
    <td style="text-align:center">Targeted</td>
    <td style="text-align:center">Plus Middle Income</td>
  </tr>
      </thead>

  <tr class="active-row">
    <td>Center-based</td>

    <td style="text-align:center"><span id='ccc_use_ba'></span></td>
    <td style="text-align:center"><span id='ccc_use_n'></span></td>
    <td style="text-align:center"><span id='ccc_use_br'></span></td>
  </tr>
  <tr>
    <td>Home-based</td>


    <td style="text-align:center"><span id='fcc_use_ba'></span></td>
    <td style="text-align:center"><span id='fcc_use_n'></span></td>
    <td style="text-align:center"><span id='fcc_use_br'></span></td>
  </tr>  

       <td colspan="4" class="cap foot">
        Percent of families with children under age 5 using licensed ECE providers
    </td>
</table>
 


 
 <div style="text-align:left ;padding: 8px; border: 1px solid #C36161;  width: 85%;><strong><font size="1.3">  
                        
 
<ul>
  <li>For data sources and methodology see <a href="https://docs.google.com/document/d/1JqbhYzF_1sY2SpJE_wQq3WY86I558w6dsOL6-DnKcXM/edit" target="_blank">Impact of Increased Early Care and Education Investments by Minnesota Legislative Districts</a>.</li>
  <li>These estimates provide context and direction for the types of expected effects from investing in these ECE policies, but the estimates are not intended to be used for detailed planning purposes by policymakers, government agencies, businesses, or families.</li> 
</ul> 
</font></strong>   </div>
 
 </div>
 
<script>
  mapboxgl.accessToken = 'pk.eyJ1Ijoid29ubGVlIiwiYSI6ImNqYjY0bHZlczBvMnAzMm16OTlyYWFzYnYifQ.yaLx92dXVMk1NKp5Fp7HUg';
  // Set bounds to San Francisco, California.
const bounds = [
[  -104.68382853903802,38.59253429376127  ], // Southwest coordinates
[-84.62130488513192,50.72237066805901 ] // Northeast coordinates
]; 
const map = new mapboxgl.Map({
container: 'map',
// Choose from Mapbox's core styles, or make your own style with Mapbox Studio
style: 'mapbox://styles/mapbox/light-v11',
zoom: 5.7,
minZoom: 5.5,
maxBounds: bounds, // Set the map's geographical boundaries.

center: [ -97.943262995056, 46.586671344255144,  ]

});   
 
let hoveredStateId  = null;
// Wait until the map has finished loading.
map.on('load', () => {



// Add a custom vector tileset source. This tileset contains
// point features representing senate2022_20230223-2j0yrl. Each feature contains
// three properties. For example:
// {
//     alt_name: "Museo Arqueologico",
//     name: "Museo Inka",
//     tourism: "museum"
// }
map.addSource('senate2022_20230223-2j0yrl', {
type: 'vector',
url: 'mapbox://wonlee.ar6wvvwj',
promoteId: 'DISTRICT'

});
map.addSource('senate2022_20230223-4hzhui', {
type: 'vector',
url: 'mapbox://wonlee.a2s634e7'
});

 
map.addLayer({
'id': 'senate2022_20230223-2j0yrl',
'type': 'fill',
'source': 'senate2022_20230223-2j0yrl',
'layout': {
// Make the layer visible by default.
'visibility': 'visible'
},
'paint': {
'fill-outline-color': '#000000',


'fill-color':[


'interpolate',
['linear'],
['get', 'base'],
0, '#daa520 ', 
],
 
'fill-opacity': [
    'case',
    ['boolean', ['feature-state', 'hover'], false],
    1,
    0.3
]
},
'source-layer': 'senate2022_20230223-2j0yrl',
});
 






// Add the Mapbox Terrain v2 vector tileset. Read more about
// the structure of data in this tileset in the documentation:
// https://docs.mapbox.com/vector-tiles/reference/mapbox-terrain-v2/

 

  

map.addSource('senate2022_pointw-ajj889', {
type: 'vector',
url: 'mapbox://wonlee.264b7pyh'
});
 
map.addLayer({
'id': 'senate2022_pointw-ajj889',
'type': 'symbol',
'source': 'senate2022_pointw-ajj889',
'layout': {

'text-field': [
'format',
['upcase', ['get', 'DISTRICT']],
{ 'font-scale': 1 },

],
'text-font': ['Open Sans Semibold', 'Arial Unicode MS Bold']
},
'source-layer': 'senate2022_pointw-ajj889',
});



map.addLayer({
'id': 'senate2022_20230223-2j0yrl',
'type': 'fill',
'source': 'senate2022_20230223-2j0yrl',
'layout': {
// Make the layer visible by default.
'visibility': 'visible'
},
'paint': {
'fill-color':[
'interpolate',
['linear'],
['get', 'base'],
0, '#334ABC',  
],
"fill-opacity": 0.25  
},
'source-layer': 'senate2022_20230223-2j0yrl',
});


 // Add a black outline around the polygon.
 
 


map.addLayer({
'id': 'senate2022_20230223-4hzhui',
'type': 'line',
'source': 'senate2022_20230223-4hzhui',
'layout': {'visibility': 'visible'
},
'paint': {
'line-color': '#634700',
'line-width': 1.5
},'source-layer': 'senate2022_20230223-4hzhui',

});










 }); 
 
// After the last frame rendered before the map enters an "idle" state.
map.on('idle', () => {
// If these two layers were not added to the map, abort
if (!map.getLayer('senate2022_pointw-ajj889') || !map.getLayer('senate2022_20230223-2j0yrl') ) {
return;
}
 
// Enumerate ids of the layers.
const toggleableLayerIds = ['senate2022_pointw-ajj889', 'senate2022_20230223-2j0yrl' ];
 
// Set up the corresponding toggle button for each layer.
for (const id of toggleableLayerIds) {
// Skip layers that already have a button set up.
if (document.getElementById(id)) {
continue;
}
 
// Create a link.
const link = document.createElement('a');
link.id = id;
link.href = '#';
link.textContent = id;
link.className = 'active';
 
// Show or hide layer when the toggle is clicked.
link.onclick = function (e) {
const clickedLayer = this.textContent;
e.preventDefault();
e.stopPropagation();
 
const visibility = map.getLayoutProperty(
clickedLayer,
'visibility'
);
 
// Toggle layer visibility by changing the layout object's visibility property.
if (visibility === 'visible') {
map.setLayoutProperty(clickedLayer, 'visibility', 'none');
this.className = '';
} else {
this.className = 'active';
map.setLayoutProperty(
clickedLayer,
'visibility',
'visible'
);
}
};
 
const layers = document.getElementById('menu');
layers.appendChild(link);
}



  



map.on('mousemove',function(e){
    var ZCTA5CE10=map.queryRenderedFeatures(e.point, {
        layers: ['senate2022_20230223-2j0yrl']
    });
    if (ZCTA5CE10.length >0) {
        document.getElementById('DISTRICT').innerHTML = ZCTA5CE10[0].properties.DISTRICT ;
    } else {
        document.getElemnentById('DISTRICT').innerHTML ='DISTRICT';
    }
});



map.on('mousemove',function(e){
    var ZCTA5CE10=map.queryRenderedFeatures(e.point, {
        layers: ['senate2022_20230223-2j0yrl']
    });
    if (ZCTA5CE10.length >0) {
        document.getElementById('n_fam_u5').innerHTML = ZCTA5CE10[0].properties.n_fam_u5.toFixed(0).replace(/\B(?=(\d{3})+(?!\d))/g, ",") ;
    } else {
        document.getElemnentById('n_fam_u5').innerHTML ='n_fam_u5';
    }
});










map.on('mousemove',function(e){
    var ZCTA5CE10=map.queryRenderedFeatures(e.point, {
        layers: ['senate2022_20230223-2j0yrl']
    });
    if (ZCTA5CE10.length >0) {
        document.getElementById('exp_ba').innerHTML = '$'+ZCTA5CE10[0].properties.exp_ba.toFixed(0).replace(/\B(?=(\d{3})+(?!\d))/g, ",") ;
    } else {
        document.getElemnentById('exp_ba').innerHTML ='exp_ba';
    }
});




map.on('mousemove',function(e){
    var ZCTA5CE10=map.queryRenderedFeatures(e.point, {
        layers: ['senate2022_20230223-2j0yrl']
    });
    if (ZCTA5CE10.length >0) {
        document.getElementById('exp_diff_n').innerHTML = '$'+ZCTA5CE10[0].properties.exp_diff_n.toFixed(0).replace(/\B(?=(\d{3})+(?!\d))/g, ",") ;
    } else {
        document.getElemnentById('exp_diff_n').innerHTML ='exp_diff_n';
    }
});


map.on('mousemove',function(e){
    var ZCTA5CE10=map.queryRenderedFeatures(e.point, {
        layers: ['senate2022_20230223-2j0yrl']
    });
    if (ZCTA5CE10.length >0) {
        document.getElementById('exp_diff_b').innerHTML = '$'+ZCTA5CE10[0].properties.exp_diff_b.toFixed(0).replace(/\B(?=(\d{3})+(?!\d))/g, ",") ;
    } else {
        document.getElemnentById('exp_diff_b').innerHTML ='exp_diff_b';
    }
});
 



 

 

 

map.on('mousemove',function(e){
    var ZCTA5CE10=map.queryRenderedFeatures(e.point, {
        layers: ['senate2022_20230223-2j0yrl']
    });
    if (ZCTA5CE10.length >0) {
        document.getElementById('DISTRICT').innerHTML = ZCTA5CE10[0].properties.DISTRICT ;
    } else {
        document.getElemnentById('DISTRICT').innerHTML ='DISTRICT';
    }
});


map.on('mousemove',function(e){
    var ZCTA5CE10=map.queryRenderedFeatures(e.point, {
        layers: ['senate2022_20230223-2j0yrl']
    });
    if (ZCTA5CE10.length >0) {
        document.getElementById('emp_ba').innerHTML = ZCTA5CE10[0].properties.emp_ba.toFixed(1)+'%' ;
    } else {
        document.getElemnentById('emp_ba').innerHTML ='emp_ba';
    }
});




map.on('mousemove',function(e){
    var ZCTA5CE10=map.queryRenderedFeatures(e.point, {
        layers: ['senate2022_20230223-2j0yrl']
    });
    if (ZCTA5CE10.length >0) {
        document.getElementById('emp_n').innerHTML = ZCTA5CE10[0].properties.emp_n.toFixed(1)+'%' ;
    } else {
        document.getElemnentById('emp_n').innerHTML ='emp_n';
    }
});


map.on('mousemove',function(e){
    var ZCTA5CE10=map.queryRenderedFeatures(e.point, {
        layers: ['senate2022_20230223-2j0yrl']
    });
    if (ZCTA5CE10.length >0) {
        document.getElementById('emp_br').innerHTML = ZCTA5CE10[0].properties.emp_br.toFixed(1)+'%' ;
    } else {
        document.getElemnentById('emp_br').innerHTML ='emp_br';
    }
});
 

map.on('mousemove',function(e){
    var ZCTA5CE10=map.queryRenderedFeatures(e.point, {
        layers: ['senate2022_20230223-2j0yrl']
    });
    if (ZCTA5CE10.length >0) {
        document.getElementById('ftemp_ba').innerHTML = ZCTA5CE10[0].properties.ftemp_ba.toFixed(1)+'%' ;
    } else {
        document.getElemnentById('ftemp_ba').innerHTML ='ftemp_ba';
    }
});




map.on('mousemove',function(e){
    var ZCTA5CE10=map.queryRenderedFeatures(e.point, {
        layers: ['senate2022_20230223-2j0yrl']
    });
    if (ZCTA5CE10.length >0) {
        document.getElementById('ftemp_n').innerHTML = ZCTA5CE10[0].properties.ftemp_n.toFixed(1)+'%' ;
    } else {
        document.getElemnentById('ftemp_n').innerHTML ='ftemp_n';
    }
});


map.on('mousemove',function(e){
    var ZCTA5CE10=map.queryRenderedFeatures(e.point, {
        layers: ['senate2022_20230223-2j0yrl']
    });
    if (ZCTA5CE10.length >0) {
        document.getElementById('ftemp_br').innerHTML = ZCTA5CE10[0].properties.ftemp_br.toFixed(1)+'%' ;
    } else {
        document.getElemnentById('ftemp_br').innerHTML ='ftemp_br';
    }
});



 



map.on('mousemove',function(e){
    var ZCTA5CE10=map.queryRenderedFeatures(e.point, {
        layers: ['senate2022_20230223-2j0yrl']
    });
    if (ZCTA5CE10.length >0) {
        document.getElementById('ccc_use_ba').innerHTML = ZCTA5CE10[0].properties.ccc_use_ba.toFixed(1)+'%' ;
    } else {
        document.getElemnentById('ccc_use_ba').innerHTML ='ccc_use_ba';
    }
});




map.on('mousemove',function(e){
    var ZCTA5CE10=map.queryRenderedFeatures(e.point, {
        layers: ['senate2022_20230223-2j0yrl']
    });
    if (ZCTA5CE10.length >0) {
        document.getElementById('ccc_use_n').innerHTML = ZCTA5CE10[0].properties.ccc_use_n.toFixed(1)+'%' ;
    } else {
        document.getElemnentById('ccc_use_n').innerHTML ='ccc_use_n';
    }
});


map.on('mousemove',function(e){
    var ZCTA5CE10=map.queryRenderedFeatures(e.point, {
        layers: ['senate2022_20230223-2j0yrl']
    });
    if (ZCTA5CE10.length >0) {
        document.getElementById('ccc_use_br').innerHTML = ZCTA5CE10[0].properties.ccc_use_br.toFixed(1)+'%' ;
    } else {
        document.getElemnentById('ccc_use_br').innerHTML ='ccc_use_br';
    }
});




map.on('mousemove',function(e){
    var ZCTA5CE10=map.queryRenderedFeatures(e.point, {
        layers: ['senate2022_20230223-2j0yrl']
    });
    if (ZCTA5CE10.length >0) {
        document.getElementById('fcc_use_ba').innerHTML = ZCTA5CE10[0].properties.fcc_use_ba.toFixed(1)+'%' ;
    } else {
        document.getElemnentById('fcc_use_ba').innerHTML ='fcc_use_ba';
    }
});




map.on('mousemove',function(e){
    var ZCTA5CE10=map.queryRenderedFeatures(e.point, {
        layers: ['senate2022_20230223-2j0yrl']
    });
    if (ZCTA5CE10.length >0) {
        document.getElementById('fcc_use_n').innerHTML = ZCTA5CE10[0].properties.fcc_use_n.toFixed(1)+'%' ;
    } else {
        document.getElemnentById('fcc_use_n').innerHTML ='fcc_use_n';
    }
});


map.on('mousemove',function(e){
    var ZCTA5CE10=map.queryRenderedFeatures(e.point, {
        layers: ['senate2022_20230223-2j0yrl']
    });
    if (ZCTA5CE10.length >0) {
        document.getElementById('fcc_use_br').innerHTML = ZCTA5CE10[0].properties.fcc_use_br.toFixed(1)+'%' ;
    } else {
        document.getElemnentById('fcc_use_br').innerHTML ='fcc_use_br';
    }
});
// Change the cursor to a pointer when the mouse is over the places layer.
map.on('mouseenter', 'senate2022_20230223-2j0yrl', () => {
map.getCanvas().style.cursor = 'pointer';
});
 
// Change it back to a pointer when it leaves.
map.on('mouseleave', 'senate2022_20230223-2j0yrl', () => {
map.getCanvas().style.cursor = '';
});
  
// When the user moves their mouse over the state-fill layer, we'll update the
// feature state for the feature under the mouse.

      map.on('mousemove', 'senate2022_20230223-2j0yrl', (e) => {
        if (e.features.length > 0) {
          if (hoveredStateId) {
            map.setFeatureState({
              source: 'senate2022_20230223-2j0yrl',
              'sourceLayer': 'senate2022_20230223-2j0yrl',
              id: hoveredStateId
            }, {
              hover: false
            });
          }
          hoveredStateId = e.features[0].id;
          map.setFeatureState({
            source: 'senate2022_20230223-2j0yrl',
            'sourceLayer': 'senate2022_20230223-2j0yrl',
            id: hoveredStateId
          }, {
            hover: true
          });
        }
      });


      map.on('mousemove', 'senate2022_20230223-2j0yrl', (e) => {

        map.getCanvas().style.cursor = 'pointer';
        const description = `
        <p>County Name: ${e.features[0].properties.county_name}</p>
        <p>County FIPS: ${e.features[0].properties.county_fips}</p>
        <p>Feature ID: ${e.features[0].id}</p>
        <p>Contributions:  ${d3.format("($.2f")(e.features[0].state.per_capita_contributions)} per capita</p>`;
        
        popup
          .setLngLat(e.lngLat)
          .setHTML(description)
          .addTo(map);
      });

      map.on('mouseleave', 'senate2022_20230223-2j0yrl', () => {
        if (hoveredStateId) {
          map.setFeatureState({
            source: 'senate2022_20230223-2j0yrl',
            'sourceLayer': 'senate2022_20230223-2j0yrl',
            id: hoveredStateId
          }, {
            hover: false
          });
        }
        hoveredStateId = null;
        map.getCanvas().style.cursor = '';
        popup.remove();
      });

});



</script>
 
</body>
</html>